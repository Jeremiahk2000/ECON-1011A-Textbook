\chapter{Firms with Multiple Inputs}

In the previous chapter, we developed the basic concepts for understanding firms' behavior by setting up a model for firms with a single input (labor) and solving for comparative statics as wages and prices change. This chapter will expand the model to include multiple inputs, which will demonstrate more generally the tools used to study models with more than one choice variable.

\section{Model Setup}

As before, firms produce according to some production function $f$, and they seek to maximize their profits $\pi$. Now, we consider the case where the firm optimizes over two inputs, capital ($K$) and labor ($L$), so we can express our production function as $f(K, L)$. In addition to these two choice variables, we have three exogenous variables: price of the product ($p$), wage ($w$), and cost of renting capital ($r$). Making the same assumptions about a perfectly competitive market for labor and the firm, we can express our profit function as 
$$\pi(K, L; p, r, w) = pf(K, L) - rK - wL.$$
The firm thus solves the optimization problem
$$\max_{K, L} \pi(K, L; p, r, w) = \max_{K, L} pf(K, L) - rK - wL.$$

\section{Solving the Model}

We want to solve the optimization problem 
$$\max_{K, L} pf(K, L) - rK - wL$$
to find the optimal values of $K^*$ and $L^*$ for the choice variables. We follow the same steps as the single variable case.

\paragraph{First Order Conditions}

Since we have two choice variables, we now have two first order conditions that must be simultaneously satisfied
$$\begin{cases}
p \frac{\partial}{\partial K} f\left(K^{*}, L^{*}\right)-r=0 \\
p \frac{\partial}{\partial L} f\left(K^{*}, L^{*}\right)-w=0.
\end{cases}$$
Rearranging gives us an implicit definition for $K^*(p, r, w)$ and $L^*(p, r, w)$:
$$\boxed{\begin{cases}
p \frac{\partial}{\partial K} f\left(K^{*}, L^{*}\right) = r \\
p \frac{\partial}{\partial L} f\left(K^{*}, L^{*}\right) = w.
\end{cases}}$$
This result carries the same intuition as the univariate case: firms will purchase an input (e.g. labor, capital) until the point where its marginal revenue product is equal to its marginal cost. 

\paragraph{Second Order Conditions}

We again check second order conditions to verify that our optimum is indeed a maximum. These conditions are trickier when we have multiple inputs: we need to make sure that our function $\pi$ at the point $(K^*, L^*)$ is not increasing in \textit{any} direction, not just the two directions along $K$ and $L$. Formally, the second order condition is satisfied in the multivariate case if and only if the Hessian matrix is negative definite (see Math Review). In the case of two variables, this condition is equivalent to checking that
$$\begin{cases}
\frac{\partial^2\pi}{\partial K^2} < 0 \\
\frac{\partial^2\pi}{\partial L^2} < 0 \\
\frac{\partial^2\pi}{\partial K^2}\frac{\partial^2\pi}{\partial L^2} - \left(\frac{\partial^2\pi}{\partial K\partial L}\right)^2 > 0.
\end{cases}$$
If we were considering a general function $\pi$, then these conditions are automatically true if $\pi$ is concave. We can check these more explicitly for our expression for profit. Like in the previous chapter, the first two conditions give
$$\begin{cases}
\frac{\partial^2\pi}{\partial K^2} = p\frac{\partial^2f}{\partial K^2}(K^*, L^*) < 0 \\
\frac{\partial^2\pi}{\partial L^2} = p\frac{\partial^2f}{\partial L^2}(K^*, L^*) < 0, \\
\end{cases}$$
which have the interpretation that the marginal revenue product of capital and labor are diminishing, as assumed. The third condition gives
$$p^2\frac{\partial^2 f}{\partial K^2}\frac{\partial^2 f}{\partial L^2} > \left(p \frac{\partial f^2}{\partial K \partial L}\right)^2,$$
or equivalently,
$$\frac{\partial^2 f}{\partial K^2}\frac{\partial^2 f}{\partial L^2} > \left(\frac{\partial f^2}{\partial K \partial L}\right)^2.$$
Intuitively, an example where this condition might not hold would be if capital and labor were very strong complements. Then, even though the marginal benefit of capital decreases with more capital and the marginal benefit of labor decreases with more labor, the marginal benefit of capital increases with more labor, enough to an extent that there still exists a direction where the production function is upward sloping. However, if we assume that the production function is concave, then this second order condition is automatically met.

\section{Comparative statics}

Now that we have implicit definitions for $K^*(p, r, w)$ and $L^*(p, r, w)$, we can take the comparative statics with respect to the exogenous variables $p$, $r$, and $w$. Here, we will take the comparative statics with respect to $w$, which means we are interested in finding $\frac{\partial K^*}{\partial w}$ and $\frac{\partial L^*}{\partial w}$ and interpreting their signs. Switching notation for our differentiation, recall that we have the first order conditions
$$\begin{cases}
p f_K\left(K^{*}, L^{*}\right) = r \\
p f_L\left(K^{*}, L^{*}\right) = w.
\end{cases}$$
that implicitly define $K^*$ and $L^*$. We can thus apply the Implicit Function Theorem and totally differentiate both of the above conditions, yielding

$$\begin{cases}
\frac{d}{d w}\left[p f_{K}\left(K^{*}(p, r, w), L^{*}(p, r, w)\right)\right]=\frac{d r}{d w} \\
\frac{d}{d w}\left[p f_{L}\left(K^{*}(p, r, w), L^{*}(p, r, w)\right)\right]=\frac{d w}{d w}.
\end{cases}$$

We can suppress the arguments to $K^*$ and $L^*$ (but do not forget that these are functions!) and simplify to get 
$$\begin{cases}
p\left(f_{K K} \frac{\partial K^{*}}{\partial w}+f_{K L} \frac{\partial L^{*}}{\partial w}\right)=0 \\
p\left(f_{L K} \frac{\partial K^{*}}{\partial w}+f_{L L} \frac{\partial L^{*}}{\partial w}\right)=1.
\end{cases}$$
We have a system of linear equations and are interested in obtaining $\frac{\partial K^*}{\partial w}$ and $\frac{\partial L^*}{\partial w}$, so we can solve our system with Gaussian elimination, substitution, Cramer's rule, or any method you prefer. Using Gaussian elimination, we can rearrange to get 
$$\begin{cases}
f_{L L} p\left(f_{K K} \frac{\partial K^{*}}{\partial w}+f_{K L} \frac{\partial L^{*}}{\partial w}\right)-f_{K L}\left[p\left(f_{L K} \frac{\partial K^{*}}{\partial w}+f_{L L} \frac{\partial L^{*}}{\partial w}\right)-1\right]=0 \\
g_{K K}\left[p\left(f_{L K} \frac{\partial K^{*}}{\partial w}+f_{L L} \frac{\partial L^{*}}{\partial w}\right)-1\right]-f_{L K} p\left(f_{K K} \frac{\partial K^{*}}{\partial w}+f_{K L} \frac{\partial L^{*}}{\partial w}\right)=0.
\end{cases}$$
Simplifying yields 
$$\begin{cases}
p f_{K K} f_{L L} \frac{\partial K^{*}}{\partial w}-p f_{K L}^{2} \frac{\partial K^{*}}{\partial w}+g_{K L}=0 \\
p f_{K K} f_{L L} \frac{\partial L^{*}}{\partial w}-f_{K K}-p f_{K L}^{2} \frac{\partial L^{*}}{\partial w}=0.
\end{cases}$$
This allows us to solve for 
$$\boxed{\begin{cases}
\frac{\partial K^{*}}{\partial w}=-\frac{1}{p} \frac{f_{K L}}{f_{K K} f_{L L}-f_{K L}^{2}} \\
\frac{\partial L^{*}}{\partial w}=\frac{1}{p} \frac{f_{K K}}{f_{K K} f_{L L}-f_{K L}^{2}}.
\end{cases}}$$

Remember that we are ultimately interested in the signs of these two terms. Notice that the $f_{K K} f_{L L}-f_{K L}^{2}$ term in each of the denominators must be positive, since this is exactly the third of our SOCs! We know that $f_{KK} < 0$ from our first SOC, so we know that 
$$\frac{\partial L^{*}}{\partial w} < 0.$$
This has the unsurprising interpretation that as wages increases, the amount of labor hired decreases. 

Notice that that the sign of $\frac{\partial K^{*}}{\partial w}$ depends on the sign of $f_{KL}$; the former is positive if and only if the latter is negative. Whether $f_{KL}$ is positive or negative depends on the specific production function $f$. If $f_{KL} > 0$, we say that capital and labor are \vocab{complements}. That is, when labor increases, the marginal product of capital increases. Thus, when wages rise and the firm hires less labor, the marginal product of capital falls, so the optimal quantity of capital rented also falls. Intuitively, when inputs are complements, if we want less of one input, then we also want less of the other.

Alternatively, if $f_{KL} < 0$, we say that capital and labor are \vocab{substitutes}. That is, when labor increases, the marginal product of capital decreases. Then, when wages rise and the firm hires less labor, the marginal product of capital increases, so the optimal quantity of capital rented also increases. This effect explains why we call the inputs substitutes: when we want less of one input, we now want more of the other.
\TODO{Include the approach using the general formula?}

\section{Returns to Scale}
As we saw in the previous section, the nature of how firms hire labor and rent capital depends a lot on the structure of the actual production function $f(K, L)$. We often care about two key questions.
\begin{enumerate}
    \item Are capital and labor substitutes or complements?
    \item What are the returns to scale? That is, does the per-unit cost of production increase or decrease as production scales up?
\end{enumerate}
We discussed the first question in the previous section; we now turn our attention to the second question. Given a production function $f(K, L)$, there are three cases:
\begin{itemize}
    \item $f(K, L)$ has \vocab{constant returns to scale} if 
    $$f(\lambda K, \lambda L) = \lambda f(K, L)$$
    for all $K, L, \lambda > 0$.
    \item $f(K, L)$ has \vocab{increasing returns to scale} if 
    $$f(\lambda K, \lambda L) > \lambda f(K, L)$$
    for all $K, L, \lambda > 1$.
    \item $f(K, L)$ has \vocab{decreasing returns to scale} if 
    $$f(\lambda K, \lambda L) < \lambda f(K, L)$$
    for all $K, L, \lambda > 1$.
\end{itemize}
Intuitively, the returns to scale tell us whether a big factory is more or less efficient than a small one. Doubling all of the inputs will always result in more production, but by how much? If doubling all of the inputs doubles output, then there are constant returns to scale. If doubling the inputs creates more than double the output, then there are increasing returns to scale. If doubling the inputs creates less than double the output, then there are decreasing returns to scale.

The returns to scale of a production function are fundamentally important to how the firm maximizes profits. If returns to scale are always increasing, then the firm will always want to produce an infinite quantity. If returns to scale are constant, then it will either (1) want to produce an infinite amount, (2) produce nothing, or (3) be indifferent across all output quantities.

\section{Specific production functions}
Now that we have the tools to study general production functions, we consider two common and useful examples.

\TODO{Add actual solutions}

\subsection*{Leontief (fixed-proportion) technology}

Here, we have the functional form
$$f(K, L)=\min \left\{\frac{K}{a_{K}}, \frac{L}{a_{L}}\right\}.$$
The interpretation of this form is that the firm needs capital and labor in specific proportions; any additional increase in one without an increase in the other will yield no extra production. For example, if it takes exactly one machine to produce one unit of product, and there must be exactly one worker operating each machine, then we would have $a_K = a_L = 1$. Notice that the returns to scale are constant; the firm will produce at infinity if the price of the product is greater than the unit cost, it will produce at 0 if the price is less than the unit cost, and it will be indifferent if the price and the cost are equal.

\subsection*{Cobb-Douglas technology}

In this case, we have the production function
$$f(K, L) = AK^\alpha L^\beta.$$
Notice that the returns to scale depend on the value of $\alpha + \beta$. The firm has increasing returns to scale if this value is greater than 1, constant returns to scale if it is equal to 1, and decreasing returns to scale if it is less than 1. We can also see that
$$\frac{\partial f^2}{\partial K \partial L} = \alpha \beta AK^{\alpha - 1} L^{\beta -1} > 0,$$
so capital and labor are complements in this model. 

\section{Long run vs. short run}

\TODO{Make footnote on bar LR/SR definition}

When we previously computed comparative statics with respect to wage, we assumed that the firm could adjust both capital and labor. However, we can also consider the case where the firm can only adjust labor in the short run, with capital fixed. For example, this might be relevant for a firm that would need a few years to build a new factory but can choose to higher more workers in the meantime to increase production.

Thus, our previous comparative static stays the same in the long run, when both capital and labor are adjustable, That is, we have 
$$\left.\frac{\partial L^{*}}{\partial w}\right|_{L R}=\frac{1}{p} \frac{f_{K K}}{f_{K K} f_{L L}-f_{K L}^{2}}=\frac{1}{p\left(f_{L L}-f_{K L}^{2} / f_{K K}\right)}$$
from before.

However, in the case where $K$ is held at a constant $\bar{K}$ in the short term, then our optimization problem becomes
$$\max_L pf(\bar{K}, L) - r\bar{K} - wL.$$
Then our first order condition becomes
$$p\frac{\partial}{\partial L} f(\bar{K}, L^*) - w = 0,$$
which gives
$$pf_L(\bar{K}, L^*) = w.$$
We want the new comparative static with respect to $w$ in the short term, so using the Implicit Function Theorem and differentiating both sides yields
$$\left.\frac{\partial L^{*}}{\partial w}\right|_{S R}=\frac{1}{p f_{L L}}.$$

Note that both the short run and long run response to a wage increase is negative, but the long run response is larger in magnitude. Intuitively, if capital and labor are substitutes, then in the long run, the increase in wages would increase capital, driving labor down even more than in the short run. If capital and labor are complements, then in the long run, the increase in wages would decrease capital, which would also result in even less labor hired. In either case, when capital is able to adjust to the wage hike, the marginal revenue product of labor goes down, so labor goes down even more than it does in the short term.

\section{Profit function}

Consider again the value function of the firm's optimization problem, which is the profit function $\pi(p, r, w)$. Remember that this function only depends on the exogenous variables $p$, $r$, and $w$, since we assume that $K$ and $L$ are already at their optimal values $K^*(p, r, w)$ and $L^*(p, r, w)$. If we wanted to write out the profit function fully, it would then look like
$$\pi(p, r, w) = pf(K^*(p, r, w), L^*(p, r, w)) - rK^*(p, r, w) - wL^*(p, r, w).$$

\subsection*{Effects of parameter changes}

What happens to profits when price changes? Taking the partial derivative with respect to $p$ gives
$$\frac{\partial \pi}{\partial p} = f(K^*, L^*),$$
which is a results known as \vocab{Hotelling's Lemma.} But wait! Where are all the $\frac{\partial K^*}{\partial p}$ and $\pdv{L^*}{p}$ terms? Recall that by the Envelope Theorem, since we are differentiating the value function with respect to the parameters, we can treat the original choice variables as constants. Intuitively, this is because the choice variables are already optimized with respect to the parameters, which means that their derivatives must be 0. \TODO{Provide proof of Envelope Theorem again, except now in multivariate case?}

We can similarly differentiate with respect to $r$ and $w$ to get that 
$$\pdv{\pi}{r} = -K^*$$
and
$$\pdv{\pi}{w} = -L^*.$$
Intuitively, this means that when input costs suddenly change by a little, the immediate impact on production is small, so the primary effect on profit comes from the additional input cost that must be paid.

\subsection*{Homogeneity}
We first introduce the concept of homogeneity.
\begin{definition}
A function $f(x_1, x_2, \ldots, x_m)$ is \vocab{homogeneous of degree $n$} if for all $\lambda > 0$, we have 
$$f\left(\lambda x_{1}, \lambda x_{2}, \ldots, \lambda x_{m}\right)=\lambda^{n} f\left(x_{1}, x_{2}, \ldots, x_{m}\right).$$
\end{definition}
Notice from our definition that homogeneity of degree 1 is equivalent to constant returns to scale. We also introduce an important theorem.

\begin{theorem}[Euler]
If $f(x_1, x_2, \ldots, x_m)$ is homogeneous of degree $n$, then 
$$x_{1} f_{x_{1}}+x_{2} f_{x_{2}}+\ldots+x_{m} f_{x_{m}}=n f\left(x_{1}, x_{2}, \ldots, x_{m}\right).$$
\end{theorem}
\TODO{Mention that we don't prove it}
Notice that this theorem means that when we have constant returns to scale (i.e. $f$ is homogeneous of degree 1), then the production is equal to the sum of all the input amounts multiplied by their marginal product.

We can now introduce an important result:
\begin{proposition}
The profit function $\pi(p, r, w)$ is homogeneous of degree 1. That is, for all $\lambda > 0$, 
$$\pi(\lambda p, \lambda r, \lambda w) = \lambda \pi(p, r, w).$$
\end{proposition}
Intuitively, this just means that if we convert all of our price units for $p$, $r$, and $w$, nothing fundamental would change---our profits would simply scale to the same amount in the new units.
\begin{proof}
Observe
$$
\begin{aligned}
\pi(\lambda p, \lambda r, \lambda w)&= \max _{K, L}\{\lambda p f(K, L)-\lambda r K-\lambda w L\} \\
&= \max _{K, L}\{\lambda[p f(K, L)-r K-w L]\} \\
&=\lambda \max _{K, L}\{p f(K, L)-r K-w L\}\\
&=\lambda \pi(p, r, w).
\end{aligned}
$$
\end{proof}

\subsection*{Convexity}
Recall the mathematically formal definition of a convex functions from \ref{def:convexity}, which is a function $f: \R^n \to \R$ such that for any $\lambda \in [0, 1], \vec{x}, \vec{y} \in \R^n$,
\begin{align*}
    f(\lambda \vec{x} + (1 - \lambda) \vec{y}) \leq \lambda f(\vec{x}) + (1 - \lambda) f(\vec{y}).
\end{align*}
We then have the following fact:
\begin{proposition*}
The profit function is convex. That is, for any sets of prices $(p_0, r_0, w_0)$ and $(p_1, r_1, w_1)$ and any $\lambda \in (0, 1)$, let
$$\left(p_{\lambda}, r_{\lambda}, w_{\lambda}\right)=\left(\lambda p_{0}+(1-\lambda) p_{1}, \lambda r_{0}+(1-\lambda) r_{1}, \lambda w_{0}+(1-\lambda) w_{1}\right)$$
be their convex combination. Then 
$$\pi\left(p_{\lambda}, r_{\lambda}, w_{\lambda}\right) \leq \lambda \pi\left(p_{0}, r_{0}, w_{0}\right)+(1-\lambda) \pi\left(p_{1}, r_{1}, w_{1}\right).$$
\end{proposition*}

\begin{proof}
Let $\vec{w} = (r, w)$ and let $\vec{Z} = (K, L)$. That is, we are pretending there is a single inpute $\vZ$ with price $\vw$. For any $(p_0, \vw_0)$ and $(p_1, \vw_1)$ and $\lambda \in (0, 1)$, let 
$$\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)=\left(\lambda p_{0}+(1-\lambda) p_{1}, \lambda \mathbf{w}_{0}+(1-\lambda) \mathbf{w}_{1}\right).$$
We want to show 
$$\pi\left(p_{\lambda}, \mathbf{w}_{\lambda}\right) \leq \lambda \pi\left(p_{0}, \mathbf{w}_{0}\right)+(1-\lambda) \pi\left(p_{1}, \mathbf{w}_{1}\right).$$

We know that at $(p_\lambda, \vw_\lambda)$, the profits are
$$\pi\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)=p_{\lambda} f\left(\mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right)-\mathbf{w}_{\lambda} \cdot \mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right),$$
where $\mathbf{Z}^{*}(p_\lambda, \vw_\lambda)$ has been optimized by the firm at prices $(p_\lambda, \vw_\lambda)$. If we tried to use the input quantity $\mathbf{Z}^{*}(p_\lambda, \vw_\lambda)$ when prices were at $(p_0, \bw_0)$ or $(p_1, \bw_1)$, the resulting profits would be weakly less than the profits $\pi(p_0, \bw_0)$ and $\pi(p_1, \bw_1)$ that have been optimized at those price points by definition. This gives us 
$$\begin{array}{l}
\pi\left(p_{0}, \mathbf{w}_{0}\right) \geq p_{0} f\left(\mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right)-\mathbf{w}_{0} \cdot \mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right) \\
\pi\left(p_{1}, \mathbf{w}_{1}\right) \geq p_{1} f\left(\mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right)-\mathbf{w}_{1} \cdot \mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right).
\end{array}
$$
We can substitute these inequalities into our convex combination expression, yielding
\begin{align*}
\lambda \pi\left(p_{0}, \mathbf{w}_{0}\right)+(1-\lambda) \pi\left(p_{1}, \mathbf{w}_{1}\right)
&\geq \lambda\left[p_{0} f\left(\mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right)-\mathbf{w}_{0} \cdot \mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right] \\
& \quad +(1-\lambda)\left[p_{1} f\left(\mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right)-\mathbf{w}_{1} \cdot \mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right] \\
&=\left[\lambda p_{0}+(1-\lambda) p_{1}\right] f\left(\mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right) \\
&\quad -\left[\lambda \mathbf{w}_{0}+(1-\lambda) \mathbf{w}_{1}\right] \cdot \mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right) \\
&=p_{\lambda} f\left(\mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right)\right)-\mathbf{w}_{\lambda} \cdot \mathbf{Z}^{*}\left(p_{\lambda}, \mathbf{w}_{\lambda}\right) \\
&=\pi\left(p_{\lambda}, \mathbf{w}_{\lambda}\right).
\end{align*}
\end{proof}
Notice that we did not even need for the profit function to be twice differentiable! The intuitive reasoning behind this proof is that average of the profits of the extreme prices would be the profits at the average prices if we chose the same inputs at the extreme prices as we did at the average price. However, we can always do weakly better at each of the extreme prices by reoptimizing our inputs compared to what we chose at the average, which means that the average profits of these extremes must be weakly greater.

How do we interpret this result? This means that given the options between (1) prices constantly fluctuating between $(p_0, w_0, r_0)$ and $(p_1, w_1, r_1)$ with some probability and (2) prices staying at their expected value always, the firm would prefer scenario (1). This is because under price fluctuations, the firm has more opportunities to reoptimize its input quantities compared to the case where prices are fixed.

\section*{Recap}
\TODO{finish this}

